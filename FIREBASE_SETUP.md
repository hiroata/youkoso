# Firebaseèªè¨¼ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰

## ğŸ”¥ Firebaseè¨­å®šæ‰‹é †

### 1. Firebaseãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ

1. [Firebase Console](https://console.firebase.google.com/)ã«ã‚¢ã‚¯ã‚»ã‚¹
2. ã€Œãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã€ã‚’ã‚¯ãƒªãƒƒã‚¯
3. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå: `youkoso-store`
4. Google Analyticsã‚’æœ‰åŠ¹åŒ–ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

### 2. èªè¨¼è¨­å®š

1. Firebaseã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ã€ŒAuthenticationã€ã‚’é¸æŠ
2. ã€Œå§‹ã‚ã‚‹ã€ã‚’ã‚¯ãƒªãƒƒã‚¯
3. ã€ŒSign-in methodã€ã‚¿ãƒ–ã§ä»¥ä¸‹ã‚’æœ‰åŠ¹åŒ–ï¼š
   - **ãƒ¡ãƒ¼ãƒ«/ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰**: æœ‰åŠ¹
   - **Google**: æœ‰åŠ¹ï¼ˆOAuthåŒæ„ç”»é¢ã®è¨­å®šãŒå¿…è¦ï¼‰

### 3. Firebaseãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¨­å®š

1. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¨­å®šï¼ˆæ­¯è»Šã‚¢ã‚¤ã‚³ãƒ³ï¼‰â†’ã€Œãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’è¨­å®šã€
2. ã€Œå…¨èˆ¬ã€ã‚¿ãƒ–ã§ã€Œã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒªã€ã‚’è¿½åŠ 
3. ã‚¢ãƒ—ãƒªå: `Youkoso Web`
4. è¡¨ç¤ºã•ã‚Œã‚‹è¨­å®šæƒ…å ±ã‚’ã‚³ãƒ”ãƒ¼

### 4. è¨­å®šæƒ…å ±ã®é©ç”¨

`js/firebase-auth.js`ã®ä»¥ä¸‹ã®éƒ¨åˆ†ã‚’æ›´æ–°ï¼š

```javascript
const firebaseConfig = {
    apiKey: "YOUR_API_KEY",              // å®Ÿéš›ã®APIã‚­ãƒ¼ã«ç½®æ›
    authDomain: "youkoso-store.firebaseapp.com",
    projectId: "youkoso-store",
    storageBucket: "youkoso-store.appspot.com",
    messagingSenderId: "YOUR_SENDER_ID", // å®Ÿéš›ã®IDã«ç½®æ›
    appId: "YOUR_APP_ID"                 // å®Ÿéš›ã®IDã«ç½®æ›
};
```

### 5. æœ€åˆã®ç®¡ç†è€…ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆ

1. `admin.html`ã‚’é–‹ã
2. ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ï¼ˆF12ï¼‰ã‚’é–‹ã
3. ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œï¼š

```javascript
// ç®¡ç†è€…ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆ
await createFirstAdmin('admin@youkoso.com', 'SecurePassword123!', 'ã‚µã‚¤ãƒˆç®¡ç†è€…');
```

### 6. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ«ãƒ¼ãƒ«è¨­å®š

Firebaseã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ã€ŒFirestore Databaseã€â†’ã€Œãƒ«ãƒ¼ãƒ«ã€ï¼š

```javascript
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±
    match /users/{userId} {
      allow read: if request.auth != null && request.auth.uid == userId;
      allow write: if request.auth != null && request.auth.uid == userId;
    }
    
    // ç®¡ç†è€…æƒ…å ±
    match /admins/{adminId} {
      allow read: if request.auth != null && request.auth.uid == adminId;
      allow write: if false; // ç®¡ç†è€…ã¯æ‰‹å‹•ã§è¨­å®š
    }
    
    // å•†å“æƒ…å ±ï¼ˆèª°ã§ã‚‚èª­ã¿å–ã‚Šå¯ã€ç®¡ç†è€…ã®ã¿æ›¸ãè¾¼ã¿å¯ï¼‰
    match /products/{productId} {
      allow read: if true;
      allow write: if request.auth != null && 
        exists(/databases/$(database)/documents/admins/$(request.auth.uid));
    }
  }
}
```

## ğŸ” ãƒ­ã‚°ã‚¤ãƒ³æƒ…å ±

### æ—§ã‚·ã‚¹ãƒ†ãƒ ï¼ˆãƒ¬ã‚¬ã‚·ãƒ¼ï¼‰
- **ID**: admin
- **ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰**: japan2024

### æ–°ã‚·ã‚¹ãƒ†ãƒ ï¼ˆFirebaseï¼‰
- **ãƒ¡ãƒ¼ãƒ«**: admin@youkoso.comï¼ˆã¾ãŸã¯ä»»æ„ã®ãƒ¡ãƒ¼ãƒ«ï¼‰
- **ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰**: è¨­å®šæ™‚ã«æŒ‡å®šã—ãŸãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰
- **Googleãƒ­ã‚°ã‚¤ãƒ³**: æœ‰åŠ¹

## ğŸš€ è¿½åŠ æ©Ÿèƒ½

### ç®¡ç†è€…ã®è¿½åŠ 
```javascript
// ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§å®Ÿè¡Œ
await window.firebaseAuth.register(
  'newadmin@youkoso.com',
  'password123',
  'æ–°ã—ã„ç®¡ç†è€…',
  'admin'  // ãƒ­ãƒ¼ãƒ«ã‚’'admin'ã«è¨­å®š
);
```

### ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚»ãƒƒãƒˆ
ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ã®ã€Œãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å¿˜ã‚ŒãŸæ–¹ã€ãƒªãƒ³ã‚¯ã‹ã‚‰ã€ãƒ¡ãƒ¼ãƒ«ã§ãƒªã‚»ãƒƒãƒˆå¯èƒ½

### ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†
- è‡ªå‹•ãƒ­ã‚°ã‚¤ãƒ³ç¶­æŒ
- ã‚¿ãƒ–é–“ã§ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³å…±æœ‰
- ã‚»ã‚­ãƒ¥ã‚¢ãªãƒˆãƒ¼ã‚¯ãƒ³ç®¡ç†

## ğŸ“ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚¨ãƒ©ãƒ¼: "auth/invalid-api-key"
â†’ `firebase-auth.js`ã®APIã‚­ãƒ¼ãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª

### ã‚¨ãƒ©ãƒ¼: "auth/user-not-found"
â†’ ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒç™»éŒ²ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª

### ã‚¨ãƒ©ãƒ¼: "auth/wrong-password"
â†’ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒæ­£ã—ã„ã‹ç¢ºèªï¼ˆå¤§æ–‡å­—å°æ–‡å­—ã‚‚åŒºåˆ¥ï¼‰

### ã‚¨ãƒ©ãƒ¼: "auth/too-many-requests"
â†’ ãƒ­ã‚°ã‚¤ãƒ³è©¦è¡ŒãŒå¤šã™ãã¾ã™ã€‚ã—ã°ã‚‰ãå¾…ã£ã¦ã‹ã‚‰å†è©¦è¡Œ

## ğŸ”„ ç§»è¡Œæ‰‹é †

1. Firebaseãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆ
2. è¨­å®šæƒ…å ±ã‚’`firebase-auth.js`ã«è¿½åŠ 
3. æœ€åˆã®ç®¡ç†è€…ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆ
4. æ–°ã—ã„ãƒ­ã‚°ã‚¤ãƒ³æƒ…å ±ã§ãƒ†ã‚¹ãƒˆ
5. æ—§èªè¨¼ã‚³ãƒ¼ãƒ‰ã‚’æ®µéšçš„ã«å‰Šé™¤

## ğŸŒŸ ãƒ¡ãƒªãƒƒãƒˆ

- **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å‘ä¸Š**: æ¥­ç•Œæ¨™æº–ã®èªè¨¼ã‚·ã‚¹ãƒ†ãƒ 
- **è¤‡æ•°ç®¡ç†è€…å¯¾å¿œ**: ç°¡å˜ã«ç®¡ç†è€…ã‚’è¿½åŠ å¯èƒ½
- **ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚»ãƒƒãƒˆ**: ãƒ¡ãƒ¼ãƒ«ã§è‡ªå‹•ãƒªã‚»ãƒƒãƒˆ
- **ã‚½ãƒ¼ã‚·ãƒ£ãƒ«ãƒ­ã‚°ã‚¤ãƒ³**: Googleèªè¨¼å¯¾å¿œ
- **ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†**: è‡ªå‹•çš„ãªãƒˆãƒ¼ã‚¯ãƒ³æ›´æ–°
- **ç›£æŸ»ãƒ­ã‚°**: ãƒ­ã‚°ã‚¤ãƒ³å±¥æ­´ã®è¨˜éŒ²